# Graph Digitizer

これは、グラフの画像ファイルからデータポイントを数値化するためのグラフィカルツールです。線形・対数軸の組み合わせに対応するキャリブレーションと、操作ログの自動保存に対応しています。

## 概要

このツールを使用すると、論文やレポートに含まれるグラフの画像から、手動でデータポイントを抽出し、CSVファイルとして保存できます。画像のパンやズームに対応しており、正確な位置でのデータ取得が可能です。

## 機能

- 画像ファイルの読み込み（PNG, JPEGなど）と手動入力によるパス指定
- x軸・y軸ごとに線形/対数スケールを選択できるキャリブレーション（線形-線形、線形-log、log-線形、log-log）
- 2点以上の基準点を用いた線形近似による座標変換の自動推定
- クリックによるデータポイント取得とリアルタイム表示
- 対数スケール選択時の入力チェック（正の値のみ受け付け）
- マウス操作による画像のパン（中クリックドラッグ）とズーム（ホイール/トラックパッド）
- 取得したデータポイントを `graph_value_output/` 配下にCSVファイルとして保存
- セッションの操作ログを `log/` 配下にタイムスタンプ付きファイルで保存

## 依存ライブラリ

このスクリプトは、以下のPythonライブラリに依存しています。

- NumPy
- Pillow

## インストール

使用前に、必要なライブラリをpipでインストールしてください。

```bash
pip install numpy pillow
```

## 使い方

1. **起動**

   コマンドラインから `graph_digitizer.py` を実行します。

   - 画像ファイルを指定せずに起動する場合（ファイル選択ダイアログが開きます）:
     ```bash
     python graph_digitizer.py
     ```

   - 画像ファイルを指定して起動する場合:
     ```bash
     python graph_digitizer.py path/to/your/image.png
     ```

2. **スケールモードの選択**

   起動直後に、x軸・y軸それぞれのスケール（線形/対数）を選択するダイアログが表示されます。対象グラフの軸に合わせて組み合わせを選んでください。

3. **キャリブレーション**

   - プログラムを起動すると、まずキャリブレーションモードになります。
   - グラフの軸上の既知の点をクリックします（例: x軸の最小値と最大値、y軸の最小値と最大値など）。
   - クリックするたびに、その点の実際の座標 (x, y) を入力するダイアログが表示されます。これにより、画像のピクセル座標とグラフの実際の座標との間の線形変換を計算します。
   - 対数スケールを選択した軸では、正の値のみ入力できます。0以下の値はエラーとなります。
   - **注意**: このプログラムの線形変換は、グラフの軸が画像の水平・垂直軸と平行であることを前提としており、画像の傾き（回転）は考慮しません。
   - 最低2点のキャリブレーションが必要です。キャリブレーションを終了すると、データ取得モードに移行します。

4. **データ取得**

   - データ取得モードでは、グラフ上のデータポイントをクリックします。
   - クリックした点の座標が計算され、ウィンドウ下部のリストに表示されます。

5. **画像の操作**

   - **パン**: マウスの中ボタンを押しながらドラッグします。
   - **ズーム**: マウスホイールをスクロールします。

6. **終了と保存**

   - 「データ取得を終了」ボタンをクリックします。
   - ファイル名を入力するダイアログが表示されます。
   - 指定したファイル名で、取得したデータが `graph_value_output` ディレクトリにCSVファイルとして保存されます。
   - セッション中の操作ログは `log/graph_digitizer_YYYYMMDD_HHMMSS.log` に保存され、コンソールにも同じ内容が出力されます。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 免責事項

本ソフトウェアの使用によって生じたいかなる損害についても、作者は一切の責任を負いません。自己の責任においてご使用ください。

